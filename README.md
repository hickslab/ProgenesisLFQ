---
title: "Progenesis QIP"
output:
  html_document:
    theme: journal
    highlight: pygments
    df_print: paged
    toc: true
    toc_float:
      collapsed: false
    number_sections: true
  pdf_document:
    toc: true
  word_document:
    toc: true
  md_document:
    toc: true
    
---





# ProteinLFQ


## Packages
**Load required packages into R session.**


```r
library(devtools)
library(tidyverse)
library(Biostrings)
```


## Functions


```r
url <- "https://raw.githubusercontent.com/hickslab/ProgenesisLFQ/master/"

source_url(paste0(url, "R/ProgenesisLFQ_Global.R"))
```

```
## SHA-1 hash of file is 46d72ef9fbf7843a06a8c125d64eaf3c02bfa2e5
```


## Workflow
> Load Protein Measurements spreadsheet exported from Progenesis.


```r
protm <- "data/20180502_WOS52_Cr_UPS_protm.csv" %>%
  paste0(url, .) %>%
  read_csv(., skip = 2, col_types = cols())
```


> Some protein accessions were grouped together by semicolons (;) in the data. These groups represent homologous proteins with shared peptide identifications. The first accession in each group is generally the most confident inference and is used for analysis, other accessions are considered group members.


```r
protm <- protm %>%
  separate(Accession,
           into = c("Accession", "Group members"),
           sep = ";",
           extra = "merge",
           fill = "right")

protm
```

```
## # A tibble: 1,982 x 34
##    Accession `Group members` `Peptide count` `Unique peptide~
##    <chr>     <chr>                     <dbl>            <dbl>
##  1 Cre06.g2~ Cre06.g263450.~              59               58
##  2 Cre12.g5~ <NA>                         52               49
##  3 Cre12.g5~ <NA>                         52               51
##  4 Cre04.g2~ <NA>                         50               48
##  5 Cre03.g1~ <NA>                         50               47
##  6 gi|41179~ <NA>                         50               47
##  7 Cre02.g0~ <NA>                         48               45
##  8 gi|41179~ <NA>                         48               47
##  9 Cre01.g0~ <NA>                         48               47
## 10 Cre01.g0~ <NA>                         46               45
## # ... with 1,972 more rows, and 30 more variables: `Confidence
## #   score` <dbl>, `Anova (p)` <dbl>, `Max fold change` <dbl>, `Highest
## #   mean condition` <chr>, `Lowest mean condition` <chr>,
## #   Description <chr>, `20141222_WOS521` <dbl>, `20141222_WOS526` <dbl>,
## #   `20141222_WOS5211` <dbl>, `20141222_WOS5216` <dbl>,
## #   `20141222_WOS522` <dbl>, `20141222_WOS527` <dbl>,
## #   `20141222_WOS5212` <dbl>, `20141222_WOS5217` <dbl>,
## #   `20141222_WOS523` <dbl>, `20141222_WOS528` <dbl>,
## #   `20141222_WOS5213` <dbl>, `20141222_WOS5218` <dbl>,
## #   `20141222_WOS521_1` <dbl>, `20141222_WOS526_1` <dbl>,
## #   `20141222_WOS5211_1` <dbl>, `20141222_WOS5216_1` <dbl>,
## #   `20141222_WOS522_1` <dbl>, `20141222_WOS527_1` <dbl>,
## #   `20141222_WOS5212_1` <dbl>, `20141222_WOS5217_1` <dbl>,
## #   `20141222_WOS523_1` <dbl>, `20141222_WOS528_1` <dbl>,
## #   `20141222_WOS5213_1` <dbl>, `20141222_WOS5218_1` <dbl>
```

> Define column indeces for the normalized abundance values.

* The Protein Measurements export from Progenesis contains the normalized and raw abundances for each raw file in the experiment.


```r
protm %>% names()
```

```
##  [1] "Accession"              "Group members"         
##  [3] "Peptide count"          "Unique peptides"       
##  [5] "Confidence score"       "Anova (p)"             
##  [7] "Max fold change"        "Highest mean condition"
##  [9] "Lowest mean condition"  "Description"           
## [11] "20141222_WOS521"        "20141222_WOS526"       
## [13] "20141222_WOS5211"       "20141222_WOS5216"      
## [15] "20141222_WOS522"        "20141222_WOS527"       
## [17] "20141222_WOS5212"       "20141222_WOS5217"      
## [19] "20141222_WOS523"        "20141222_WOS528"       
## [21] "20141222_WOS5213"       "20141222_WOS5218"      
## [23] "20141222_WOS521_1"      "20141222_WOS526_1"     
## [25] "20141222_WOS5211_1"     "20141222_WOS5216_1"    
## [27] "20141222_WOS522_1"      "20141222_WOS527_1"     
## [29] "20141222_WOS5212_1"     "20141222_WOS5217_1"    
## [31] "20141222_WOS523_1"      "20141222_WOS528_1"     
## [33] "20141222_WOS5213_1"     "20141222_WOS5218_1"
```


```r
samples <- 11:22

samples
```

```
##  [1] 11 12 13 14 15 16 17 18 19 20 21 22
```


> Filter to remove proteins from the contaminant database. 

> Filter to remove proteins if not enough peptide evidence.

* Proteins are identified by unique and shared PSMs, so usually the confidence in our protein identification is greatest with increasing unique peptides. It is common in proteomics to remove "one-hit-wonders" by requiring > 1 unique peptide per protein.

> Select the identifier and abundance columns.


```r
data <- protm %>%
  filter(Description != "cRAP") %>%
  filter(`Peptide count` >= 2 & `Unique peptides` >= 1) %>%
  select(Accession, samples) %>%
  data.frame()

data
```

```
##                             Accession X20141222_WOS521 X20141222_WOS526
## 1  Cre06.g263450.t1.2|PACid:30779125|       61176.2173       57254.2405
## 2  Cre12.g516200.t1.2|PACid:30792542|       13727.5122       12720.9093
## 3  Cre12.g512300.t1.2|PACid:30791835|        5829.7794        5617.1821
## 4  Cre04.g222700.t1.2|PACid:30791597|        4531.2865        4279.3648
## 5  Cre03.g180750.t1.2|PACid:30787285|       21020.4463       20439.5231
## 6        gi|41179057|ref|NP_958414.1|       68112.1644       61717.6985
## 7  Cre02.g080200.t1.2|PACid:30786367|       15508.4663       16112.5791
## 8        gi|41179049|ref|NP_958405.1|      122937.6867      116088.6745
## 9  Cre01.g010900.t1.2|PACid:30788366|       44773.3012       42271.9006
## 10 Cre01.g042750.t1.2|PACid:30789585|        7692.8388        7353.1760
## 11           P02787ups|TRFE_HUMAN_UPS        4807.8017        4573.7208
## 12 Cre03.g204250.t1.2|PACid:30788072|       12704.3519       12974.1706
## 13 Cre06.g250100.t1.2|PACid:30778980|        8903.7378        8318.3548
## 14 Cre08.g372100.t1.2|PACid:30774022|        8286.2784        7503.6301
## 15 Cre11.g467770.t1.1|PACid:30775977|       27881.4407       26744.9106
## 16 Cre07.g353450.t1.2|PACid:30774591|       10271.8210        9755.2587
## 17 Cre05.g234550.t1.2|PACid:30783068|       53004.7884       49546.9410
## 18 Cre06.g282800.t1.2|PACid:30779483|       32687.4368       32593.5397
## 19       gi|41179050|ref|NP_958406.1|       52405.6011       48893.0096
## 20           P02788ups|TRFL_HUMAN_UPS        2970.5124        2641.1031
## 21 Cre02.g116750.t1.1|PACid:30784898|       11090.9606       10509.6975
## 22 Cre07.g339150.t1.1|PACid:30775388|        5294.7521        4678.7361
## 23       gi|41179032|ref|NP_958388.1|       38875.9650       37478.7074
## 24 Cre12.g514050.t1.2|PACid:30792611|        1178.5432        1178.7193
## 25 Cre04.g229300.t1.1|PACid:30791545|       11989.8225       12032.0107
## 26 Cre03.g194850.t1.2|PACid:30788115|       15560.0087       14480.0645
## 27 Cre12.g542250.t1.1|PACid:30793243|       19308.8912       18156.5390
## 28 Cre09.g396213.t1.1|PACid:30780284|       84069.1159       79425.9787
## 29 Cre09.g393150.t1.2|PACid:30780797|       48948.4032       46934.9011
## 30 Cre17.g698000.t1.2|PACid:30782086|       13501.3554       12939.7302
## 31 Cre12.g513200.t1.2|PACid:30792008|       10400.2748        9827.5087
## 32 Cre02.g141400.t1.2|PACid:30784858|       12743.4276       12091.4525
## 33 Cre06.g269050.t1.2|PACid:30779340|        3066.0635        2903.4119
## 34 Cre12.g490350.t1.1|PACid:30792879|        1790.3939        1688.2626
## 35 Cre17.g720250.t1.2|PACid:30782643|       30493.9065       27891.3832
## 36 Cre04.g231222.t1.1|PACid:30791114|        4227.0474        3882.5043
## 37 Cre02.g081250.t1.2|PACid:30785406|        2325.7289        2198.1121
## 38 Cre08.g358580.t1.1|PACid:30774147|        1699.6353        1579.8524
## 39 Cre07.g325500.t1.1|PACid:30775304|        1673.5502        1651.5820
## 40       gi|41179007|ref|NP_958362.1|       21490.1436       20456.9894
## 41 Cre01.g050950.t1.2|PACid:30789075|        6999.5084        6531.1896
## 42 Cre03.g144807.t1.1|PACid:30786652|        8783.2851        8091.0516
## 43 Cre13.g565800.t1.2|PACid:30784628|        8598.1615        8251.3215
## 44 Cre02.g076250.t1.1|PACid:30786008|        3438.4584        3213.1129
## 45 Cre03.g149100.t1.2|PACid:30787831|        4661.7265        4301.3577
## 46 Cre13.g567950.t1.2|PACid:30784437|        3050.4799        2728.9886
## 47 Cre03.g190950.t1.2|PACid:30788226|       16713.6707       15999.4891
## 48 Cre06.g259900.t1.2|PACid:30779752|        7657.7406        7238.1673
## 49 Cre01.g039300.t1.2|PACid:30789032|        3344.2734        3145.0356
## 50 Cre12.g550850.t1.2|PACid:30791734|       68165.8265       65277.5832
## 51 Cre03.g189800.t1.2|PACid:30787830|        2902.2040        2675.0338
## 52           P02768ups|ALBU_HUMAN_UPS        2291.8473        2264.6628
## 53 Cre11.g476750.t1.2|PACid:30775686|       16834.1811       15804.9074
## 54 Cre13.g603700.t1.2|PACid:30784404|       13605.5163       12791.6464
## 55 Cre06.g306300.t1.2|PACid:30778583|        4588.5289        4350.7841
## 56 Cre07.g344400.t1.2|PACid:30774785|        4636.6578        4378.9394
## 57 Cre07.g325736.t1.1|PACid:30774660|        3213.1378        2954.4741
## 58 Cre06.g250200.t1.2|PACid:30779081|       20944.2602       19160.5272
## 59 Cre06.g308250.t1.2|PACid:30778562|        5193.2804        5426.3990
## 60 Cre17.g720050.t1.2|PACid:30782442|        4010.8557        3616.9478
## 61 Cre10.g434750.t1.2|PACid:30789728|        6903.7752        6734.8062
## 62 Cre08.g359350.t1.2|PACid:30773866|        5321.8905        4912.0937
## 63 Cre12.g483700.t1.2|PACid:30793634|        3223.6819        3086.5421
## 64 Cre06.g278210.t1.1|PACid:30779668|        2846.5602        2908.7402
## 65 Cre02.g076350.t1.2|PACid:30785110|        3004.2036        2934.9422
## 66 Cre16.g664550.t1.2|PACid:30776923|        3245.8065        3036.0381
## 67 Cre06.g269950.t1.2|PACid:30778959|         891.7011         906.0363
## 68 Cre03.g185550.t1.2|PACid:30788192|       14923.0096       14390.9211
## 69 Cre12.g485800.t1.2|PACid:30791981|        4094.4180        3648.2868
## 70 Cre09.g397697.t1.1|PACid:30781440|        6179.1037        5955.2726
## 71 Cre07.g340350.t1.1|PACid:30774678|        4090.5524        3782.0725
## 72 Cre06.g272050.t1.2|PACid:30779959|        3003.1973        2846.9400
## 73 Cre01.g044800.t1.2|PACid:30789628|        1365.1767        1274.2277
## 74 Cre12.g537200.t1.2|PACid:30792850|        1495.3552        1524.5729
## 75       gi|41179003|ref|NP_958358.1|       17409.4242       16602.6197
## 76 Cre13.g604650.t1.2|PACid:30784625|        7166.5157        6781.4596
##    X20141222_WOS5211 X20141222_WOS5216 X20141222_WOS522 X20141222_WOS527
## 1         57339.2672        57219.8237       54645.6721        55403.686
## 2         13132.2432        13136.4518       12835.0056        12575.201
## 3          5528.4255         5622.6244        5244.3677         5448.258
## 4          4286.4358         4162.1331        4330.9240         4428.236
## 5         20828.6752        20217.3900       19799.0982        19312.816
## 6         64671.8393        63604.7338       62882.6552        61194.674
## 7         17148.2134        17439.4596       16432.2724        15903.080
## 8        118135.4674       115910.2810      113212.4770       113347.067
## 9         42842.8734        44368.6538       44117.9511        42926.772
## 10         7225.1806         7287.8972        7138.7394         7046.545
## 11         4352.5069         4312.6240        7488.2867         7539.376
## 12        13224.7544        13809.3371       13495.3330        12984.979
## 13         8501.8358         8384.4396        8335.8067         8432.555
## 14         7559.6612         7655.8294        7668.8480         6966.286
## 15        27357.3758        27014.1879       25504.9411        25893.486
## 16         9757.5812         9806.4238        9446.2923         9601.606
## 17        50175.3164        48110.3461       48210.1325        46946.617
## 18        31501.9350        30952.8002       31028.5312        31369.487
## 19        49567.7990        50034.8103       47624.4321        46835.838
## 20         2411.1682         2741.6986        5015.2080         5136.575
## 21        10477.2108        10568.5621       10457.7276        10407.679
## 22         4852.2700         4818.9328        5023.4010         4549.423
## 23        38125.8517        38222.3262       36052.5267        35946.742
## 24         1136.3104         1199.3515        1100.6906         1066.141
## 25        12281.2726        12514.3058       11578.4571        11983.213
## 26        15014.3402        14443.4999       15121.0803        14277.764
## 27        18414.8867        18974.7476       17613.0521        17860.978
## 28        78523.4942        81102.4093       79717.7553        77761.820
## 29        47496.6678        47353.0327       47386.8679        46640.647
## 30        12695.2796        13051.8347       12615.7398        12361.010
## 31         9570.5327         9568.2121        9305.9884         9494.592
## 32        11849.3314        12013.8948       11451.8140        11423.467
## 33         2855.0408         2955.1220        2972.7423         2300.415
## 34         1735.6675         1859.5121        1660.8693         1645.907
## 35        27051.8199        29079.0836       26645.0752        26964.291
## 36         3710.7055         3734.0230        3631.1963         3879.074
## 37         2343.0196         2340.0803        2280.0909         2213.011
## 38         1641.1858         1703.8305        1556.2955         1514.415
## 39         1714.6541         1617.4102        1589.6880         1558.725
## 40        20760.8393        20560.4434       19769.0640        20188.977
## 41         6660.3609         6699.6871        6594.3974         6402.523
## 42         8287.5461         8266.1860        8322.6022         7833.313
## 43         8297.2179         8258.2258        8035.3260         8129.786
## 44         3186.4689         3030.9508        3308.8606         3123.821
## 45         4188.0840         4304.2713        3855.3863         4043.428
## 46         2943.5730         2753.7884        2698.0892         2753.421
## 47        15925.9094        15675.3853       16100.4491        15141.891
## 48         7220.2172         7347.0927        7382.4883         7129.667
## 49         2988.3930         3170.2779        2977.1792         3057.230
## 50        67028.8142        69251.6960       65331.5573        64249.914
## 51         2775.3723         2683.8866        2600.9262         2544.724
## 52         2278.5561         2106.9030        3736.7341         3452.922
## 53        16258.0032        16677.3515       16388.0982        15718.257
## 54        12843.3493        12684.3583       12660.3736        12879.803
## 55         4058.1681         4348.9472        4220.4164         4346.917
## 56         4500.0038         4657.6254        4357.1931         4389.178
## 57         2967.2166         2874.5157        2940.5424         2853.597
## 58        19370.9194        19656.4551       19633.3921        19218.664
## 59         5690.8678         5488.6291        4880.7575         5372.952
## 60         3635.7272         3951.8113        3538.5288         3687.784
## 61         6561.3324         6806.6351        6647.3080         6249.893
## 62         5130.4628         5034.2018        5112.3780         4793.453
## 63         3013.8880         3190.5055        3060.5465         3044.197
## 64         2735.9169         2816.8690        2836.7251         2706.087
## 65         2873.9581         3027.8974        2758.6011         2897.245
## 66         3067.3802         2997.7144        2959.9998         2978.343
## 67          883.5389          938.6202         852.3125          866.645
## 68        14544.6809        14509.6945       14184.3627        14171.529
## 69         3821.2197         3914.5180        4315.6479         4014.523
## 70         5838.3963         5937.0825        5476.1989         5669.016
## 71         3989.4816         4127.8267        3901.3841         3719.218
## 72         2920.9320         2942.4266        2863.8959         2822.965
## 73         1301.2962         1279.3542        1186.5017         1233.487
## 74         1460.9887         1574.8793        1499.1340         1463.821
## 75        16983.2110        16904.9909       16743.0279        16097.258
## 76         6901.1319         6925.1273        6550.1793         6416.040
##    X20141222_WOS5212 X20141222_WOS5217 X20141222_WOS523 X20141222_WOS528
## 1         57516.4039        57306.3134       55166.1627       56644.9838
## 2         13143.6626        12814.2141       12658.3935       12567.6511
## 3          5425.7171         5419.5143        5273.0150        5204.4797
## 4          4317.5221         4301.8660        4609.8038        4350.2043
## 5         20528.4960        19995.8046       19341.0104       19181.6589
## 6         63355.0563        62705.2642       61918.5984       61420.4197
## 7         17527.5469        16839.6164       15969.3181       15630.8243
## 8        114423.7707       116229.8347      112143.4860      111916.5524
## 9         43029.2603        43751.7858       41716.3781       41301.1854
## 10         7174.4538         6946.2349        7079.1370        7045.4079
## 11         7653.0200         7360.7114       13088.4253       12750.8999
## 12        13809.6941        13613.4948       12860.5866       13056.0259
## 13         8461.2860         8047.7899        8117.8912        8137.5780
## 14         7944.0288         7078.0870        7501.4964        7803.0217
## 15        26639.8681        26666.9136       26081.7992       25414.6904
## 16         9711.7270         9705.2921        9631.2346        9349.2747
## 17        51613.4629        50582.4714       49978.2050       46867.4367
## 18        31693.2407        30837.3077       30784.2308       30486.1896
## 19        49062.2666        49161.4690       48148.9532       46625.1560
## 20         5080.7546         5552.6764        8848.2745        9040.5359
## 21        10687.3202        10288.6091       10279.5482       10398.8088
## 22         4710.8446         5425.3717        5029.0835        4882.7937
## 23        37371.0643        35657.9021       33985.0065       35371.7137
## 24         1152.1590         1118.6075        1102.1212        1099.4982
## 25        11952.9658        12384.4253       11596.5248       11411.1744
## 26        14813.6281        15014.8332       14764.2181       14349.0211
## 27        18281.5095        18818.7495       18012.1128       17740.9831
## 28        76566.1766        77637.3574       75445.4544       75742.2153
## 29        46601.4023        47873.7139       48706.8423       45450.6833
## 30        13133.5916        12840.8440       12722.5318       12209.3034
## 31         9838.1316         9879.0432        9498.9992        9437.4337
## 32        11700.5508        11837.2514       10965.7243       11517.5696
## 33         2990.6606         2986.4819        2940.6280        3005.7089
## 34         1698.9494         1854.8084        1644.7725        1642.3965
## 35        27320.0633        27725.9990       25668.4732       26688.9984
## 36         3886.9524         3811.8301        3756.6468        3761.3769
## 37         2182.6952         2256.3690        2261.3698        2223.2855
## 38         1568.3390         1539.9906        1592.3066        1400.0650
## 39         1560.5839         1524.9598        1502.0315        1577.4154
## 40        21072.5610        20549.7443       20027.0642       20090.0685
## 41         6691.2838         6515.1378        6480.1539        6499.4914
## 42         8158.2709         8021.0682        7857.4938        7761.8356
## 43         8300.7067         7017.8230        8863.5697        7862.5416
## 44         3296.4796         3199.5408        3277.5705        3221.2347
## 45         4461.6558         4084.5205        3953.5877        3913.2031
## 46         2838.0206         2649.2886        2505.9966        2739.5855
## 47        15495.6745        15235.2448       15332.9086       15205.5566
## 48         7233.1397         7509.4700        7190.1606        7237.3093
## 49         3108.1557         3061.2617        2992.9134        2944.1911
## 50        68959.5402        66898.9692       64768.0505       63254.6370
## 51         2570.6715         2660.6258        2629.2592        2607.6198
## 52         3188.6086         3298.8485        5803.3304        5540.5241
## 53        16322.1701        15734.7090       15971.4524       15728.6023
## 54        12175.3061        12919.8871       12455.3627       12015.8729
## 55         4155.6693         4476.0045        4215.8184        4146.3066
## 56         4477.8549         4541.1221        4385.6546        4411.7350
## 57         2975.0756         2895.0060        3013.1689        2989.8005
## 58        19414.1907        19339.9947       19305.9714       18761.1022
## 59         5510.8060         5164.5547        5161.5565        5212.2088
## 60         3826.8962         3611.5213        3632.9956        3494.6132
## 61         7140.9524         6289.2258        6767.7179        8266.9216
## 62         4919.0152         4983.8027        5048.8369        4659.0367
## 63         3177.1652         2996.7546        3158.3994        3088.4210
## 64         3038.5907         3086.8001        2817.0037        2689.9787
## 65         2903.9012         3071.8628        2805.2598        2834.6670
## 66         2952.0521         2952.3689        2931.7969        2927.9258
## 67          945.5412          887.8927         832.5646         856.4631
## 68        14974.8151        14860.8007       15307.0142       13889.6273
## 69         4213.0558         4037.0649        4770.6723        4668.7155
## 70         5729.3983         5737.7626        5693.7952        5595.0281
## 71         4008.0045         3994.5775        3839.6882        3819.9524
## 72         2638.9431         2344.4202        2667.8835        2641.2321
## 73         1322.8781         1256.2515        1164.2559        1168.7831
## 74         1564.6448         1464.8411        1474.7159        1358.0909
## 75        17057.4235        16778.3316       16265.1572       16058.7727
## 76         6877.4391         6691.1738        6561.3346        6477.0654
##    X20141222_WOS5213 X20141222_WOS5218
## 1         56033.6785        60098.7578
## 2         12737.9813        12733.6913
## 3          5567.6243         5618.3563
## 4          4596.4566         4575.6572
## 5         19670.8380        20221.1156
## 6         61940.3866        62294.9429
## 7         16476.0317        17177.3911
## 8        115846.7724       115293.3763
## 9         42655.0908        42421.3382
## 10         7062.7076         7063.1756
## 11        13265.3253        12783.4646
## 12        13335.6996        13793.8770
## 13         8566.0818         8543.0502
## 14         7700.8042         7412.8954
## 15        26384.5834        26504.1222
## 16         9587.0836         9748.2076
## 17        50193.7390        48435.1471
## 18        32103.3734        30792.5453
## 19        48161.7299        48648.9778
## 20         8989.2795         9362.5952
## 21        10848.2016        10422.1547
## 22         4908.4248         4821.7969
## 23        36111.2954        36620.7963
## 24         1187.2327         1180.9347
## 25        12079.3475        11851.6534
## 26        15462.4351        14636.0518
## 27        18227.0081        18443.2142
## 28        74549.0310        78835.4678
## 29        48087.0964        47519.2804
## 30        12666.9698        12727.8253
## 31         9633.1170         9579.7344
## 32        11264.0205        12088.9858
## 33         2930.4232         2941.0481
## 34         1681.5337         1677.6240
## 35        26136.4498        27690.4554
## 36         3921.3754         3735.2964
## 37         2343.3387         2273.4183
## 38         1479.7137         1400.9140
## 39         1682.8923         1579.3365
## 40        20109.5198        20175.1503
## 41         6502.0970         6689.6834
## 42         7897.4629         7775.3786
## 43         7249.6691         7878.2396
## 44         2907.3556         3096.1063
## 45         4231.5941         4209.5613
## 46         2156.2713         2886.2120
## 47        15407.1455        15123.4612
## 48         7238.0449         7227.3807
## 49         3075.0514         2941.1249
## 50        67513.9886        68776.0751
## 51         2688.0807         2705.2173
## 52         5977.2955         5701.0646
## 53        15653.7133        15753.3315
## 54        12781.8954        12717.7889
## 55         3884.2065         4310.3091
## 56         4618.2224         4630.8904
## 57         2973.2468         3048.1295
## 58        18788.1945        19079.7095
## 59         5428.8114         5487.6185
## 60         3589.1687         3630.2399
## 61         6649.0790         6755.5812
## 62         4933.9194         4682.6156
## 63         3128.7958         3242.8352
## 64         3106.3949         2662.3803
## 65         2916.4074         2883.5839
## 66         2985.3024         2902.0739
## 67          906.7262          914.6296
## 68        15028.7931        15046.2439
## 69         4718.8773         4745.7999
## 70         5741.2618         5691.9205
## 71         4017.8714         3875.3123
## 72         2698.0198         2747.9363
## 73         1181.9979         1235.0456
## 74         1519.1097         1556.1758
## 75        16916.2516        16849.6732
## 76         6696.3216         6760.2782
##  [ reached 'max' / getOption("max.print") -- omitted 1170 rows ]
```


> Example plot construction.


```r
plot_jitter <- function(df){
  temp.df <- df %>%
    gather(sample, abundance, -1)
  
  temp.df %>%  
    ggplot(., aes(x = sample, y = abundance, color = sample)) +
    geom_jitter(alpha = 0.5) +
    geom_boxplot(color = "black",
                 fill = NA,
                 outlier.shape = NA,
                 size = 1.5) +
    guides(color = FALSE, fill = FALSE) +
    theme_classic(base_size = 32) +
    coord_flip()

}

data %>% plot_jitter()
```

![plot of chunk unnamed-chunk-8](figure/unnamed-chunk-8-1.png)


# PeptideLFQ

> Peptide-Level Quantification

* During raw MS file processing, Progenesis subdivided each LC-MS run into peak features, which are MS1 precursor ions with a defined isotopic cluster with characteristic retention time and monoisotopic mass. The same peak feature coordinates are assigned for every LC-MS run and the summed intensity (abundance) from each is recorded.

* MS2 spectra from data-dependent acquisition (DDA) contain the associated MS1 precursor ion mass and retention time, allowing them to be mapped to peak features.

* The Peptide Measurements export from Progenesis contains the normalized abundances, raw abundances, and spectral counts for each identified peptide that was mapped to a MS1 peak feature in each raw file.


## Packages
> Load required packages into R session.


```r
library(devtools)
library(tidyverse)
library(Biostrings)
```


## Functions


```r
url <- "https://raw.githubusercontent.com/hickslab/ProgenesisLFQ/master/"

source_url(paste0(url, "R/ProgenesisLFQ_Peptide.R"))
```

```
## SHA-1 hash of file is 4696e657853f00386fbdb70cfb61001bd220c3fa
```


## Workflow

### Peptides
> Load Peptide Measurements spreadsheet exported from Progenesis.


```r
pepm <- "data/20180502_WOS52_Cr_UPS_pepm.csv" %>%
  paste0(url, .) %>%
  read_csv(., skip = 2, col_types = cols())
```


> Load Protein Measurements spreadsheet exported from Progenesis.


```r
protm <- "data/20180502_WOS52_Cr_UPS_protm.csv" %>%
  paste0(url, .) %>%
  read_csv(., skip = 2, col_types = cols())
```


### Redox
> Load Peptide Measurements spreadsheet exported from Progenesis.


```r
pepm <- "data/20190123_EWM_AZD1_R_rank-lessthan11-include_uniprot_pepm.csv" %>%
  paste0(url, .) %>%
  read_csv(., skip = 2, col_types = cols())

pepm
```

```
## # A tibble: 10,211 x 66
##      `#` `Retention time~ Charge `m/z` `Measured mass` `Mass error (u)`
##    <dbl>            <dbl>  <dbl> <dbl>           <dbl>            <dbl>
##  1   130            38.2       2  664.           1327.        0.00337  
##  2   917            38.2       3  443.           1327.        0.00274  
##  3  5147            38.2       1 1328.           1327.        0.00973  
##  4   164            42.4       2  420.            837.        0.00153  
##  5   592            42.5       1  838.            837.        0.00422  
##  6  5285            43.9       2  420.            837.        0.0000464
##  7 13698             1.56      2  420.            837.        0.000358 
##  8 15100             2.38      2  420.            837.        0.000578 
##  9 21044             2.08      2  420.            837.        0.00453  
## 10 21065             1.15      2  420.            837.        0.000253 
## # ... with 10,201 more rows, and 60 more variables: `Mass error
## #   (ppm)` <dbl>, Score <chr>, Sequence <chr>, Modifications <chr>,
## #   Accession <chr>, Description <chr>, `Use in quantitation` <lgl>, `Max
## #   fold change` <dbl>, `Highest mean condition` <chr>, `Lowest mean
## #   condition` <chr>, Anova <dbl>, `Maximum CV` <dbl>,
## #   `20190123_EWM_AZD1_R0_1_2h_5-35_5uL` <dbl>,
## #   `20190123_EWM_AZD1_R0_2_2h_5-35_5uL` <dbl>,
## #   `20190123_EWM_AZD1_R0_3_2h_5-35_5uL` <dbl>,
## #   `20190123_EWM_AZD1_R0_4_2h_5-35_5uL` <dbl>,
## #   `20190123_EWM_AZD1_R15_1_2h_5-35_5uL` <dbl>,
## #   `20190123_EWM_AZD1_R15_2_2h_5-35_5uL` <dbl>,
## #   `20190123_EWM_AZD1_R15_3_2h_5-35_5uL` <dbl>,
## #   `20190123_EWM_AZD1_R15_4_2h_5-35_5uL` <dbl>,
## #   `20190123_EWM_AZD1_R30_1_2h_5-35_5uL` <dbl>,
## #   `20190123_EWM_AZD1_R30_2_2h_5-35_5uL` <dbl>,
## #   `20190123_EWM_AZD1_R30_3_2h_5-35_5uL` <dbl>,
## #   `20190123_EWM_AZD1_R30_4_2h_5-35_5uL` <dbl>,
## #   `20190123_EWM_AZD1_R60_1_2h_5-35_5uL` <dbl>,
## #   `20190123_EWM_AZD1_R60_2_2h_5-35_5uL` <dbl>,
## #   `20190123_EWM_AZD1_R60_3_2h_5-35_5uL` <dbl>,
## #   `20190123_EWM_AZD1_R60_4_2h_5-35_5uL` <dbl>,
## #   `20190123_EWM_AZD1_R0_1_2h_5-35_5uL_1` <dbl>,
## #   `20190123_EWM_AZD1_R0_2_2h_5-35_5uL_1` <dbl>,
## #   `20190123_EWM_AZD1_R0_3_2h_5-35_5uL_1` <dbl>,
## #   `20190123_EWM_AZD1_R0_4_2h_5-35_5uL_1` <dbl>,
## #   `20190123_EWM_AZD1_R15_1_2h_5-35_5uL_1` <dbl>,
## #   `20190123_EWM_AZD1_R15_2_2h_5-35_5uL_1` <dbl>,
## #   `20190123_EWM_AZD1_R15_3_2h_5-35_5uL_1` <dbl>,
## #   `20190123_EWM_AZD1_R15_4_2h_5-35_5uL_1` <dbl>,
## #   `20190123_EWM_AZD1_R30_1_2h_5-35_5uL_1` <dbl>,
## #   `20190123_EWM_AZD1_R30_2_2h_5-35_5uL_1` <dbl>,
## #   `20190123_EWM_AZD1_R30_3_2h_5-35_5uL_1` <dbl>,
## #   `20190123_EWM_AZD1_R30_4_2h_5-35_5uL_1` <dbl>,
## #   `20190123_EWM_AZD1_R60_1_2h_5-35_5uL_1` <dbl>,
## #   `20190123_EWM_AZD1_R60_2_2h_5-35_5uL_1` <dbl>,
## #   `20190123_EWM_AZD1_R60_3_2h_5-35_5uL_1` <dbl>,
## #   `20190123_EWM_AZD1_R60_4_2h_5-35_5uL_1` <dbl>,
## #   `20190123_EWM_AZD1_R0_1_2h_5-35_5uL_2` <dbl>,
## #   `20190123_EWM_AZD1_R0_2_2h_5-35_5uL_2` <dbl>,
## #   `20190123_EWM_AZD1_R0_3_2h_5-35_5uL_2` <dbl>,
## #   `20190123_EWM_AZD1_R0_4_2h_5-35_5uL_2` <dbl>,
## #   `20190123_EWM_AZD1_R15_1_2h_5-35_5uL_2` <dbl>,
## #   `20190123_EWM_AZD1_R15_2_2h_5-35_5uL_2` <dbl>,
## #   `20190123_EWM_AZD1_R15_3_2h_5-35_5uL_2` <dbl>,
## #   `20190123_EWM_AZD1_R15_4_2h_5-35_5uL_2` <dbl>,
## #   `20190123_EWM_AZD1_R30_1_2h_5-35_5uL_2` <dbl>,
## #   `20190123_EWM_AZD1_R30_2_2h_5-35_5uL_2` <dbl>,
## #   `20190123_EWM_AZD1_R30_3_2h_5-35_5uL_2` <dbl>,
## #   `20190123_EWM_AZD1_R30_4_2h_5-35_5uL_2` <dbl>,
## #   `20190123_EWM_AZD1_R60_1_2h_5-35_5uL_2` <dbl>,
## #   `20190123_EWM_AZD1_R60_2_2h_5-35_5uL_2` <dbl>,
## #   `20190123_EWM_AZD1_R60_3_2h_5-35_5uL_2` <dbl>,
## #   `20190123_EWM_AZD1_R60_4_2h_5-35_5uL_2` <dbl>
```


> Load Protein Measurements spreadsheet exported from Progenesis.


```r
protm <- "data/20190123_EWM_AZD1_R_rank-lessthan11-include_uniprot_protm.csv" %>%
  paste0(url, .) %>%
  read_csv(., skip = 2, col_types = cols())

protm
```

```
## # A tibble: 2,341 x 41
##    Accession `Peptide count` `Unique peptide~ `Confidence sco~ `Anova (p)`
##    <chr>               <dbl>            <dbl>            <dbl>       <dbl>
##  1 tr|A8J3S~               1                1             23.3    8.88e-16
##  2 tr|Q3HTK~              10               10            440.     6.34e-14
##  3 tr|A8HZF~               1                1             48.3    9.66e-13
##  4 tr|A0A2K~              10               10            559.     1.42e-12
##  5 tr|A8HWQ~               1                1             40.2    8.19e-12
##  6 tr|A0A2K~               3                3            202.     3.87e-11
##  7 tr|A0A2K~               3                3            106.     1.76e-10
##  8 tr|A8J8I~               8                7            354.     1.84e- 9
##  9 tr|A8J1F~               5                5            195.     2.17e- 9
## 10 tr|A8JIB~               1                1             33.8    6.64e- 9
## # ... with 2,331 more rows, and 36 more variables: `Max fold
## #   change` <dbl>, `Highest mean condition` <chr>, `Lowest mean
## #   condition` <chr>, Description <chr>,
## #   `20190123_EWM_AZD1_R0_1_2h_5-35_5uL` <dbl>,
## #   `20190123_EWM_AZD1_R0_2_2h_5-35_5uL` <dbl>,
## #   `20190123_EWM_AZD1_R0_3_2h_5-35_5uL` <dbl>,
## #   `20190123_EWM_AZD1_R0_4_2h_5-35_5uL` <dbl>,
## #   `20190123_EWM_AZD1_R15_1_2h_5-35_5uL` <dbl>,
## #   `20190123_EWM_AZD1_R15_2_2h_5-35_5uL` <dbl>,
## #   `20190123_EWM_AZD1_R15_3_2h_5-35_5uL` <dbl>,
## #   `20190123_EWM_AZD1_R15_4_2h_5-35_5uL` <dbl>,
## #   `20190123_EWM_AZD1_R30_1_2h_5-35_5uL` <dbl>,
## #   `20190123_EWM_AZD1_R30_2_2h_5-35_5uL` <dbl>,
## #   `20190123_EWM_AZD1_R30_3_2h_5-35_5uL` <dbl>,
## #   `20190123_EWM_AZD1_R30_4_2h_5-35_5uL` <dbl>,
## #   `20190123_EWM_AZD1_R60_1_2h_5-35_5uL` <dbl>,
## #   `20190123_EWM_AZD1_R60_2_2h_5-35_5uL` <dbl>,
## #   `20190123_EWM_AZD1_R60_3_2h_5-35_5uL` <dbl>,
## #   `20190123_EWM_AZD1_R60_4_2h_5-35_5uL` <dbl>,
## #   `20190123_EWM_AZD1_R0_1_2h_5-35_5uL_1` <dbl>,
## #   `20190123_EWM_AZD1_R0_2_2h_5-35_5uL_1` <dbl>,
## #   `20190123_EWM_AZD1_R0_3_2h_5-35_5uL_1` <dbl>,
## #   `20190123_EWM_AZD1_R0_4_2h_5-35_5uL_1` <dbl>,
## #   `20190123_EWM_AZD1_R15_1_2h_5-35_5uL_1` <dbl>,
## #   `20190123_EWM_AZD1_R15_2_2h_5-35_5uL_1` <dbl>,
## #   `20190123_EWM_AZD1_R15_3_2h_5-35_5uL_1` <dbl>,
## #   `20190123_EWM_AZD1_R15_4_2h_5-35_5uL_1` <dbl>,
## #   `20190123_EWM_AZD1_R30_1_2h_5-35_5uL_1` <dbl>,
## #   `20190123_EWM_AZD1_R30_2_2h_5-35_5uL_1` <dbl>,
## #   `20190123_EWM_AZD1_R30_3_2h_5-35_5uL_1` <dbl>,
## #   `20190123_EWM_AZD1_R30_4_2h_5-35_5uL_1` <dbl>,
## #   `20190123_EWM_AZD1_R60_1_2h_5-35_5uL_1` <dbl>,
## #   `20190123_EWM_AZD1_R60_2_2h_5-35_5uL_1` <dbl>,
## #   `20190123_EWM_AZD1_R60_3_2h_5-35_5uL_1` <dbl>,
## #   `20190123_EWM_AZD1_R60_4_2h_5-35_5uL_1` <dbl>
```


> Load protein sequence database.


```r
database <- "data/Cr_uniprot_crap_20190130.fasta" %>%
  readAAStringSet(.)

names(database) <- str_split(names(database), " ", simplify = TRUE)[, 1]

database
```

```
##   A AAStringSet instance of length 18944
##         width seq                                      names               
##     [1]   751 MTISTPEREAKKVKIAVDR...GGIATTWSFFLARIISVG sp|P12154|PSAA_CHLRE
##     [2]   735 MATKLFPKFSQGLAQDPTT...YIFTYAAFLIASTSGRFG sp|P09144|PSAB_CHLRE
##     [3]    81 MAHIVKIYDTCIGCTQCVR...SVRVYLGSESTRSMGLSY sp|Q00914|PSAC_CHLRE
##     [4]    43 MIFDFNYIHIFMLTITSYV...LVFTLGIYLGLLKVVKLI sp|P50369|PETL_CHLRE
##     [5]   160 MSVTKKPDLSDPVLKAKLA...LGIGSTFPIDISLTLGLF sp|P23230|PETD_CHLRE
##     ...   ... ...
## [18940]   238 MSKGEELFTGVVPILVELD...LEFVTAAGITHGMDELYK sp|GFP_AEQVI
## [18941]   204 MAEEVEEERLKYLDFVRAA...LPLLPTEKITKVFGDEAS sp|SRPP_HEVBR
## [18942]   138 MAEDEDNQQGQGEGLKYLG...SSLPGQTKILAKVFYGEN sp|REF_HEVBR
## [18943]   348 MFSSVMVALVSLAVAVSAN...VMNADNHEYFSENNPAQS sp|PLMP_GRIFR
## [18944]   271 MSHIQRETSCSRPRLNSNL...DNPDMNKLQFHLMLDEFF sp|KKA1_ECOLX
```


> Define column indeces for the normalized abundance values.


```r
pepm %>% names()
```

```
##  [1] "#"                                    
##  [2] "Retention time (min)"                 
##  [3] "Charge"                               
##  [4] "m/z"                                  
##  [5] "Measured mass"                        
##  [6] "Mass error (u)"                       
##  [7] "Mass error (ppm)"                     
##  [8] "Score"                                
##  [9] "Sequence"                             
## [10] "Modifications"                        
## [11] "Accession"                            
## [12] "Description"                          
## [13] "Use in quantitation"                  
## [14] "Max fold change"                      
## [15] "Highest mean condition"               
## [16] "Lowest mean condition"                
## [17] "Anova"                                
## [18] "Maximum CV"                           
## [19] "20190123_EWM_AZD1_R0_1_2h_5-35_5uL"   
## [20] "20190123_EWM_AZD1_R0_2_2h_5-35_5uL"   
## [21] "20190123_EWM_AZD1_R0_3_2h_5-35_5uL"   
## [22] "20190123_EWM_AZD1_R0_4_2h_5-35_5uL"   
## [23] "20190123_EWM_AZD1_R15_1_2h_5-35_5uL"  
## [24] "20190123_EWM_AZD1_R15_2_2h_5-35_5uL"  
## [25] "20190123_EWM_AZD1_R15_3_2h_5-35_5uL"  
## [26] "20190123_EWM_AZD1_R15_4_2h_5-35_5uL"  
## [27] "20190123_EWM_AZD1_R30_1_2h_5-35_5uL"  
## [28] "20190123_EWM_AZD1_R30_2_2h_5-35_5uL"  
## [29] "20190123_EWM_AZD1_R30_3_2h_5-35_5uL"  
## [30] "20190123_EWM_AZD1_R30_4_2h_5-35_5uL"  
## [31] "20190123_EWM_AZD1_R60_1_2h_5-35_5uL"  
## [32] "20190123_EWM_AZD1_R60_2_2h_5-35_5uL"  
## [33] "20190123_EWM_AZD1_R60_3_2h_5-35_5uL"  
## [34] "20190123_EWM_AZD1_R60_4_2h_5-35_5uL"  
## [35] "20190123_EWM_AZD1_R0_1_2h_5-35_5uL_1" 
## [36] "20190123_EWM_AZD1_R0_2_2h_5-35_5uL_1" 
## [37] "20190123_EWM_AZD1_R0_3_2h_5-35_5uL_1" 
## [38] "20190123_EWM_AZD1_R0_4_2h_5-35_5uL_1" 
## [39] "20190123_EWM_AZD1_R15_1_2h_5-35_5uL_1"
## [40] "20190123_EWM_AZD1_R15_2_2h_5-35_5uL_1"
## [41] "20190123_EWM_AZD1_R15_3_2h_5-35_5uL_1"
## [42] "20190123_EWM_AZD1_R15_4_2h_5-35_5uL_1"
## [43] "20190123_EWM_AZD1_R30_1_2h_5-35_5uL_1"
## [44] "20190123_EWM_AZD1_R30_2_2h_5-35_5uL_1"
## [45] "20190123_EWM_AZD1_R30_3_2h_5-35_5uL_1"
## [46] "20190123_EWM_AZD1_R30_4_2h_5-35_5uL_1"
## [47] "20190123_EWM_AZD1_R60_1_2h_5-35_5uL_1"
## [48] "20190123_EWM_AZD1_R60_2_2h_5-35_5uL_1"
## [49] "20190123_EWM_AZD1_R60_3_2h_5-35_5uL_1"
## [50] "20190123_EWM_AZD1_R60_4_2h_5-35_5uL_1"
## [51] "20190123_EWM_AZD1_R0_1_2h_5-35_5uL_2" 
## [52] "20190123_EWM_AZD1_R0_2_2h_5-35_5uL_2" 
## [53] "20190123_EWM_AZD1_R0_3_2h_5-35_5uL_2" 
## [54] "20190123_EWM_AZD1_R0_4_2h_5-35_5uL_2" 
## [55] "20190123_EWM_AZD1_R15_1_2h_5-35_5uL_2"
## [56] "20190123_EWM_AZD1_R15_2_2h_5-35_5uL_2"
## [57] "20190123_EWM_AZD1_R15_3_2h_5-35_5uL_2"
## [58] "20190123_EWM_AZD1_R15_4_2h_5-35_5uL_2"
## [59] "20190123_EWM_AZD1_R30_1_2h_5-35_5uL_2"
## [60] "20190123_EWM_AZD1_R30_2_2h_5-35_5uL_2"
## [61] "20190123_EWM_AZD1_R30_3_2h_5-35_5uL_2"
## [62] "20190123_EWM_AZD1_R30_4_2h_5-35_5uL_2"
## [63] "20190123_EWM_AZD1_R60_1_2h_5-35_5uL_2"
## [64] "20190123_EWM_AZD1_R60_2_2h_5-35_5uL_2"
## [65] "20190123_EWM_AZD1_R60_3_2h_5-35_5uL_2"
## [66] "20190123_EWM_AZD1_R60_4_2h_5-35_5uL_2"
```


```r
samples <- 19:34

samples
```

```
##  [1] 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34
```


> Filter to keep peptides with Percolator-adjusted Mascot scores > 13 (*p*-value < 0.05).

> Filter to remove peptides from proteins in the contaminant database.

> Join the protein identification statistics onto the Peptide Measurement data.

* Each peptide was assigned to a single protein accession, which will have identification statistics in the Protein Measurements export file.

> Summarize duplicate peak features.

* There are usually instances of the Peptide Measurements with duplicated peak features and differing peptide identifications:

    + Some features were matched with peptides having identical sequence, modifications, and score, but alternate protein accessions. These groups were reduced to satisfy the principle of parsimony and represented by the protein accession with the highest number of unique peptides, else the protein with the largest confidence score assigned by Progenesis.
    
    + Some features were also duplicated with differing peptide identifications and were reduced to a single peptide with the highest Mascot ion score.
    

> Select the identifier and abundance columns.


```r
data <- pepm %>%
  filter(Score > 13) %>%
  filter(Description != "cRAP") %>%
  left_join(., protm, by = "Accession") %>%
  #reduce_features() %>%
  reduce_features_tidy() %>%
  filter_redox(reduced = "NEM") %>%
  get_identifier_redox(database = database, reduced = "NEM") %>%
  reduce_identifiers(group = samples) %>%
  select(Identifier, samples) %>%
  data.frame()

data
```

```
##                                   Identifier
## 1                  sp|P00877|RBL_CHLRE--C247
## 2                  sp|P00877|RBL_CHLRE--C449
## 3                  sp|P06541|ATPB_CHLRE--C53
## 4                  sp|P06541|ATPB_CHLRE--C63
## 5                 sp|P29683|CHLN_CHLRE--C345
## 6                 sp|P29683|CHLN_CHLRE--C349
## 7                 sp|P36437|CHLB_CHLRE--C476
## 8                  sp|Q00914|PSAC_CHLRE--C11
## 9              sp|Q00914|PSAC_CHLRE--C11-C14
## 10         sp|Q00914|PSAC_CHLRE--C11-C14-C17
## 11     sp|Q00914|PSAC_CHLRE--C11-C14-C17-C21
## 12             sp|Q00914|PSAC_CHLRE--C11-C17
## 13                 sp|Q00914|PSAC_CHLRE--C14
## 14             sp|Q00914|PSAC_CHLRE--C14-C17
## 15                 sp|Q00914|PSAC_CHLRE--C21
## 16             sp|Q00914|PSAC_CHLRE--C21-C34
## 17                 sp|Q00914|PSAC_CHLRE--C34
## 18                 sp|Q00914|PSAC_CHLRE--C48
## 19             sp|Q00914|PSAC_CHLRE--C48-C51
## 20         sp|Q00914|PSAC_CHLRE--C48-C51-C54
## 21                 sp|Q00914|PSAC_CHLRE--C51
## 22             sp|Q00914|PSAC_CHLRE--C51-C54
## 23         sp|Q00914|PSAC_CHLRE--C51-C54-C58
## 24                 sp|Q00914|PSAC_CHLRE--C54
## 25     tr|A0A2K3CNL2|A0A2K3CNL2_CHLRE--C1335
## 26      tr|A0A2K3CNY6|A0A2K3CNY6_CHLRE--C172
## 27      tr|A0A2K3CNZ8|A0A2K3CNZ8_CHLRE--C132
## 28      tr|A0A2K3CP74|A0A2K3CP74_CHLRE--C179
## 29      tr|A0A2K3CPL3|A0A2K3CPL3_CHLRE--C749
## 30      tr|A0A2K3CPL6|A0A2K3CPL6_CHLRE--C381
## 31      tr|A0A2K3CPL6|A0A2K3CPL6_CHLRE--C384
## 32       tr|A0A2K3CPX1|A0A2K3CPX1_CHLRE--C29
## 33        tr|A0A2K3CPX1|A0A2K3CPX1_CHLRE--C5
## 34      tr|A0A2K3CPY6|A0A2K3CPY6_CHLRE--C330
## 35      tr|A0A2K3CQ29|A0A2K3CQ29_CHLRE--C360
## 36      tr|A0A2K3CQE3|A0A2K3CQE3_CHLRE--C149
## 37     tr|A0A2K3CR29|A0A2K3CR29_CHLRE--C1022
## 38     tr|A0A2K3CRG7|A0A2K3CRG7_CHLRE--C4-C6
## 39  tr|A0A2K3CRG7|A0A2K3CRG7_CHLRE--C4-C6-C8
## 40      tr|A0A2K3CRS9|A0A2K3CRS9_CHLRE--C243
## 41      tr|A0A2K3CRS9|A0A2K3CRS9_CHLRE--C536
## 42      tr|A0A2K3CS52|A0A2K3CS52_CHLRE--C211
## 43      tr|A0A2K3CSG3|A0A2K3CSG3_CHLRE--C478
## 44      tr|A0A2K3CSG3|A0A2K3CSG3_CHLRE--C484
## 45       tr|A0A2K3CSU0|A0A2K3CSU0_CHLRE--C47
## 46       tr|A0A2K3CTL2|A0A2K3CTL2_CHLRE--C29
## 47        tr|A0A2K3CU03|A0A2K3CU03_CHLRE--C8
## 48      tr|A0A2K3CUZ4|A0A2K3CUZ4_CHLRE--C186
## 49       tr|A0A2K3CV04|A0A2K3CV04_CHLRE--C23
## 50       tr|A0A2K3CV40|A0A2K3CV40_CHLRE--C12
## 51     tr|A0A2K3CV50|A0A2K3CV50_CHLRE--C3-C7
## 52      tr|A0A2K3CVA1|A0A2K3CVA1_CHLRE--C294
## 53 tr|A0A2K3CVA1|A0A2K3CVA1_CHLRE--C294-C299
## 54 tr|A0A2K3CVA1|A0A2K3CVA1_CHLRE--C299-C300
## 55      tr|A0A2K3CVB0|A0A2K3CVB0_CHLRE--C322
## 56      tr|A0A2K3CVB0|A0A2K3CVB0_CHLRE--C531
## 57 tr|A0A2K3CVK4|A0A2K3CVK4_CHLRE--C676-C716
## 58      tr|A0A2K3CVP8|A0A2K3CVP8_CHLRE--C272
##    X20190123_EWM_AZD1_R0_1_2h_5.35_5uL.x
## 1                           1.332164e+03
## 2                           7.606122e+02
## 3                           2.112567e+03
## 4                           2.958884e+03
## 5                           1.063167e+03
## 6                           5.869058e+02
## 7                           3.029648e+01
## 8                           2.029289e+05
## 9                           2.012303e+05
## 10                          4.280848e+02
## 11                          4.054552e+03
## 12                          3.732783e+01
## 13                          5.331603e+04
## 14                          5.780896e+03
## 15                          6.337601e+05
## 16                          6.335556e+03
## 17                          1.982299e+05
## 18                          1.386467e+05
## 19                          8.158848e+02
## 20                          3.267344e+04
## 21                          1.528588e+04
## 22                          6.539248e+03
## 23                          1.495035e+04
## 24                          3.506551e+05
## 25                          3.390690e+01
## 26                          1.850307e+01
## 27                          1.637224e+01
## 28                          1.026860e+02
## 29                          9.425381e+01
## 30                          8.254950e+01
## 31                          3.015927e+02
## 32                          3.780092e+01
## 33                          2.328582e+03
## 34                          1.162300e+02
## 35                          3.459712e+03
## 36                          1.514335e+01
## 37                          3.056607e+01
## 38                          1.938407e+02
## 39                          1.043521e+02
## 40                          1.729527e+02
## 41                          1.614528e+02
## 42                          2.345724e+02
## 43                          6.824689e+02
## 44                          4.067075e+02
## 45                          6.080315e+02
## 46                          2.119320e+01
## 47                          1.249575e-01
## 48                          2.713975e+01
## 49                          6.638650e+01
## 50                          1.945747e+00
## 51                          1.172669e+03
## 52                          8.827775e+02
## 53                          1.703835e+03
## 54                          7.209627e+02
## 55                          3.670505e+02
## 56                          7.760407e+02
## 57                          4.821510e+00
## 58                          1.061248e+03
##    X20190123_EWM_AZD1_R0_2_2h_5.35_5uL.x
## 1                           1.580888e+03
## 2                           8.864533e+02
## 3                           1.528006e+03
## 4                           2.072867e+03
## 5                           7.955670e+02
## 6                           5.694766e+02
## 7                           4.821330e+01
## 8                           1.555781e+05
## 9                           1.665042e+05
## 10                          2.455693e+01
## 11                          7.293985e+03
## 12                          1.141369e+02
## 13                          4.098152e+04
## 14                          5.628349e+03
## 15                          6.127973e+05
## 16                          5.112315e+03
## 17                          2.056191e+05
## 18                          1.495153e+05
## 19                          1.013717e+03
## 20                          2.628421e+04
## 21                          2.012846e+04
## 22                          6.927110e+03
## 23                          1.563415e+04
## 24                          3.004089e+05
## 25                          7.138321e+01
## 26                          1.577767e+01
## 27                          3.383003e+01
## 28                          8.362707e+01
## 29                          6.185105e+01
## 30                          7.255522e+01
## 31                          2.123991e+02
## 32                          2.538535e+01
## 33                          1.891798e+03
## 34                          1.165297e+02
## 35                          2.779598e+03
## 36                          5.717982e+00
## 37                          4.146370e+01
## 38                          1.685764e+02
## 39                          1.424018e+02
## 40                          1.916632e+02
## 41                          1.610551e+02
## 42                          2.027356e+02
## 43                          4.839586e+02
## 44                          2.826410e+02
## 45                          6.937925e+02
## 46                          1.520847e+01
## 47                          0.000000e+00
## 48                          3.114712e+01
## 49                          4.963148e+01
## 50                          0.000000e+00
## 51                          1.164293e+03
## 52                          9.865576e+02
## 53                          1.972763e+03
## 54                          8.867308e+02
## 55                          3.979763e+02
## 56                          7.294671e+02
## 57                          1.313014e+01
## 58                          9.873160e+02
##    X20190123_EWM_AZD1_R0_3_2h_5.35_5uL.x
## 1                           1.711933e+03
## 2                           9.144467e+02
## 3                           1.430797e+03
## 4                           1.839058e+03
## 5                           8.145657e+02
## 6                           3.540647e+02
## 7                           5.957654e+01
## 8                           1.687988e+05
## 9                           1.722430e+05
## 10                          4.804803e+02
## 11                          5.080420e+03
## 12                          8.872185e+01
## 13                          4.618285e+04
## 14                          6.222946e+03
## 15                          6.272708e+05
## 16                          5.528774e+03
## 17                          1.789331e+05
## 18                          1.718466e+05
## 19                          1.038993e+03
## 20                          3.219995e+04
## 21                          2.293926e+04
## 22                          6.948669e+03
## 23                          1.511681e+04
## 24                          3.499018e+05
## 25                          3.987884e+01
## 26                          2.063247e+01
## 27                          3.201611e+01
## 28                          8.424081e+01
## 29                          7.952431e+01
## 30                          8.924221e+01
## 31                          4.633571e+01
## 32                          2.266824e+01
## 33                          2.248008e+03
## 34                          1.488046e+02
## 35                          3.414305e+03
## 36                          1.006916e+01
## 37                          4.114442e+01
## 38                          2.105235e+02
## 39                          1.955963e+02
## 40                          1.704366e+02
## 41                          1.823881e+02
## 42                          1.410920e+02
## 43                          4.373955e+02
## 44                          2.201158e+02
## 45                          6.522131e+02
## 46                          2.218117e+01
## 47                          0.000000e+00
## 48                          2.276339e+01
## 49                          4.073413e+01
## 50                          2.873630e+00
## 51                          1.022803e+03
## 52                          9.953720e+02
## 53                          2.150360e+03
## 54                          9.299459e+02
## 55                          4.328394e+02
## 56                          7.773470e+02
## 57                          6.155657e+00
## 58                          1.063300e+03
##    X20190123_EWM_AZD1_R0_4_2h_5.35_5uL.x
## 1                           1.522887e+03
## 2                           8.325263e+02
## 3                           1.960667e+03
## 4                           2.846342e+03
## 5                           1.072094e+03
## 6                           4.587764e+02
## 7                           7.765498e+01
## 8                           1.530840e+05
## 9                           1.625887e+05
## 10                          3.777651e+02
## 11                          3.813898e+03
## 12                          7.137962e+01
## 13                          4.143311e+04
## 14                          4.492490e+03
## 15                          6.340374e+05
## 16                          6.279562e+03
## 17                          1.934656e+05
## 18                          1.578634e+05
## 19                          7.848643e+02
## 20                          2.213396e+04
## 21                          1.921025e+04
## 22                          6.519035e+03
## 23                          1.438358e+04
## 24                          3.471848e+05
## 25                          2.320177e+01
## 26                          1.276963e+01
## 27                          3.276290e+01
## 28                          1.247810e+02
## 29                          8.568873e+01
## 30                          1.057182e+02
## 31                          1.998559e+02
## 32                          2.610246e+01
## 33                          2.016620e+03
## 34                          9.960426e+01
## 35                          3.360207e+03
## 36                          1.719699e+01
## 37                          7.414176e+01
## 38                          2.101913e+02
## 39                          1.512205e+02
## 40                          1.559532e+02
## 41                          1.555016e+02
## 42                          2.070979e+02
## 43                          6.283749e+02
## 44                          3.750187e+02
## 45                          5.830806e+02
## 46                          1.867926e+01
## 47                          7.082219e-01
## 48                          1.605203e+01
## 49                          4.742035e+01
## 50                          1.738300e+02
## 51                          1.032741e+03
## 52                          8.024179e+02
## 53                          1.734307e+03
## 54                          7.175967e+02
## 55                          4.415186e+02
## 56                          6.532382e+02
## 57                          0.000000e+00
## 58                          1.050438e+03
##    X20190123_EWM_AZD1_R15_1_2h_5.35_5uL.x
## 1                            1.459392e+03
## 2                            9.071852e+02
## 3                            1.130083e+03
## 4                            2.831691e+03
## 5                            7.623366e+02
## 6                            3.987140e+02
## 7                            7.385728e+01
## 8                            1.519371e+05
## 9                            1.494780e+05
## 10                           4.872757e+02
## 11                           3.709598e+03
## 12                           8.338339e+01
## 13                           4.006186e+04
## 14                           4.230735e+03
## 15                           5.560249e+05
## 16                           5.824115e+03
## 17                           1.686953e+05
## 18                           1.561575e+05
## 19                           9.732675e+02
## 20                           2.407010e+04
## 21                           2.122982e+04
## 22                           6.599777e+03
## 23                           1.358372e+04
## 24                           3.305007e+05
## 25                           0.000000e+00
## 26                           1.157374e+01
## 27                           7.930703e+01
## 28                           1.177374e+02
## 29                           4.367396e+01
## 30                           1.653955e+02
## 31                           1.980899e+02
## 32                           2.483291e+01
## 33                           2.049160e+03
## 34                           1.529103e+02
## 35                           2.990324e+03
## 36                           4.935373e+00
## 37                           2.685270e+01
## 38                           1.749992e+02
## 39                           1.923035e+02
## 40                           1.623434e+02
## 41                           2.049850e+02
## 42                           1.280099e+02
## 43                           6.087361e+02
## 44                           3.173179e+02
## 45                           5.053051e+02
## 46                           3.633833e+01
## 47                           0.000000e+00
## 48                           7.182398e+01
## 49                           4.250764e+01
## 50                           1.278119e+02
## 51                           9.262694e+02
## 52                           1.032970e+03
## 53                           1.723429e+03
## 54                           8.085283e+02
## 55                           4.941836e+02
## 56                           6.551919e+02
## 57                           0.000000e+00
## 58                           1.107329e+03
##    X20190123_EWM_AZD1_R15_2_2h_5.35_5uL.x
## 1                            1.571326e+03
## 2                            1.009169e+03
## 3                            1.162362e+03
## 4                            2.850796e+03
## 5                            1.141563e+03
## 6                            4.919171e+02
## 7                            7.118082e+01
## 8                            1.738988e+05
## 9                            1.481519e+05
## 10                           2.579950e+02
## 11                           1.640912e+03
## 12                           9.430709e+01
## 13                           4.758856e+04
## 14                           3.971140e+03
## 15                           5.118378e+05
## 16                           8.689629e+03
## 17                           1.479084e+05
## 18                           1.767829e+05
## 19                           9.337768e+02
## 20                           2.473395e+04
## 21                           2.521137e+04
## 22                           8.280631e+03
## 23                           1.343094e+04
## 24                           3.825528e+05
## 25                           2.710053e+01
## 26                           2.370361e+01
## 27                           5.460707e+01
## 28                           1.374268e+02
## 29                           4.219253e+01
## 30                           1.754317e+02
## 31                           1.648838e+02
## 32                           2.034318e+01
## 33                           2.048117e+03
## 34                           6.442584e+01
## 35                           3.124157e+03
## 36                           0.000000e+00
## 37                           1.239900e+02
## 38                           1.751070e+02
## 39                           2.753441e+02
## 40                           1.653755e+02
## 41                           1.384032e+02
## 42                           1.463922e+02
## 43                           5.408080e+02
## 44                           3.323874e+02
## 45                           5.531125e+02
## 46                           1.952540e+01
## 47                           1.333654e+01
## 48                           5.625583e+01
## 49                           3.484582e+01
## 50                           2.069624e+00
## 51                           1.037675e+03
## 52                           1.039061e+03
## 53                           1.765083e+03
## 54                           8.067179e+02
## 55                           5.511353e+02
## 56                           6.631932e+02
## 57                           0.000000e+00
## 58                           1.156937e+03
##    X20190123_EWM_AZD1_R15_3_2h_5.35_5uL.x
## 1                              1668.15828
## 2                               865.22440
## 3                               933.31178
## 4                              2246.92928
## 5                              1175.25322
## 6                               531.63258
## 7                                45.89949
## 8                            151783.38262
## 9                            164403.28657
## 10                              172.64507
## 11                             1351.50028
## 12                              161.02544
## 13                            40879.82687
## 14                             4057.30471
## 15                           475844.54968
## 16                            10316.46901
## 17                           145142.71040
## 18                           167371.67454
## 19                              979.01699
## 20                            22397.73136
## 21                            21707.61314
## 22                             7382.37703
## 23                            15303.54618
## 24                           422700.80104
## 25                               22.75194
## 26                               21.84900
## 27                               74.70126
## 28                              263.12296
## 29                               44.05954
## 30                              152.71448
## 31                              571.05819
## 32                                0.00000
## 33                             2212.75337
## 34                              137.59136
## 35                             3131.86883
## 36                               16.85336
## 37                               19.48748
## 38                              115.91764
## 39                              151.75130
## 40                              219.12868
## 41                               87.87183
## 42                              131.00232
## 43                              470.38473
## 44                              338.61117
## 45                              605.19923
## 46                               48.97335
## 47                                0.00000
## 48                               56.73527
## 49                               49.89462
## 50                                0.00000
## 51                             1182.12548
## 52                             1298.23772
## 53                             1897.78380
## 54                              788.54891
## 55                              496.77367
## 56                              783.57256
## 57                                0.00000
## 58                             1227.80844
##    X20190123_EWM_AZD1_R15_4_2h_5.35_5uL.x
## 1                            1.516796e+03
## 2                            6.756702e+02
## 3                            1.281333e+03
## 4                            3.055628e+03
## 5                            9.666846e+02
## 6                            5.056103e+02
## 7                            5.197713e+01
## 8                            1.077740e+05
## 9                            1.501839e+05
## 10                           5.606924e+02
## 11                           3.834336e+03
## 12                           8.076873e+01
## 13                           2.808530e+04
## 14                           4.043689e+03
## 15                           6.009181e+05
## 16                           6.907672e+03
## 17                           1.803232e+05
## 18                           1.657997e+05
## 19                           6.205426e+02
## 20                           1.300719e+04
## 21                           2.355969e+04
## 22                           4.855417e+03
## 23                           1.179221e+04
## 24                           2.675530e+05
## 25                           2.728124e+01
## 26                           2.047684e+01
## 27                           6.857978e+01
## 28                           2.154792e+02
## 29                           1.852677e+01
## 30                           1.647017e+02
## 31                           4.700357e+02
## 32                           1.758862e+01
## 33                           1.951344e+03
## 34                           1.214826e+02
## 35                           1.950723e+03
## 36                           0.000000e+00
## 37                           4.011774e+01
## 38                           1.191047e+02
## 39                           2.163934e+02
## 40                           2.024474e+02
## 41                           1.845852e+02
## 42                           1.402163e+02
## 43                           6.752940e+02
## 44                           3.481262e+02
## 45                           5.295802e+02
## 46                           2.202930e+01
## 47                           0.000000e+00
## 48                           5.754869e+01
## 49                           5.873473e+01
## 50                           1.226185e+02
## 51                           1.021032e+03
## 52                           1.069073e+03
## 53                           1.721282e+03
## 54                           7.080067e+02
## 55                           5.038715e+02
## 56                           7.070625e+02
## 57                           5.779495e+00
## 58                           1.180046e+03
##    X20190123_EWM_AZD1_R30_1_2h_5.35_5uL.x
## 1                            1.663437e+03
## 2                            7.164966e+02
## 3                            1.285099e+03
## 4                            2.644600e+03
## 5                            9.300419e+02
## 6                            5.266542e+02
## 7                            3.240058e+01
## 8                            1.626660e+05
## 9                            1.831338e+05
## 10                           4.401991e+00
## 11                           3.613394e+03
## 12                           1.871973e+02
## 13                           4.422786e+04
## 14                           4.920588e+03
## 15                           5.835241e+05
## 16                           1.152345e+04
## 17                           1.621310e+05
## 18                           1.784373e+05
## 19                           1.248577e+03
## 20                           2.692356e+04
## 21                           2.340638e+04
## 22                           7.499331e+03
## 23                           1.571782e+04
## 24                           3.543378e+05
## 25                           8.783957e+00
## 26                           5.168033e+01
## 27                           7.541474e+01
## 28                           2.794862e+02
## 29                           3.788043e+01
## 30                           1.272836e+02
## 31                           5.915697e+02
## 32                           3.838648e+01
## 33                           2.133710e+03
## 34                           1.567903e+02
## 35                           2.977565e+03
## 36                           3.157959e+00
## 37                           2.374902e+01
## 38                           2.341057e+02
## 39                           1.896355e+02
## 40                           1.213727e+02
## 41                           1.355612e+02
## 42                           1.248874e+02
## 43                           5.492789e+02
## 44                           3.186281e+02
## 45                           6.789097e+02
## 46                           1.329974e+01
## 47                           3.932834e+00
## 48                           5.537687e+01
## 49                           4.135677e+01
## 50                           0.000000e+00
## 51                           1.242392e+03
## 52                           1.239462e+03
## 53                           2.108216e+03
## 54                           9.236184e+02
## 55                           4.369972e+02
## 56                           7.458443e+02
## 57                           3.139404e+00
## 58                           1.380859e+03
##    X20190123_EWM_AZD1_R30_2_2h_5.35_5uL.x
## 1                            1.587530e+03
## 2                            7.530148e+02
## 3                            1.195832e+03
## 4                            2.640722e+03
## 5                            1.072158e+03
## 6                            5.917284e+02
## 7                            1.189473e+01
## 8                            1.572297e+05
## 9                            1.816571e+05
## 10                           9.816231e-01
## 11                           2.871193e+03
## 12                           4.430258e+02
## 13                           4.372277e+04
## 14                           5.149262e+03
## 15                           7.029812e+05
## 16                           7.074486e+03
## 17                           1.850507e+05
## 18                           1.932111e+05
## 19                           9.496596e+02
## 20                           2.803903e+04
## 21                           2.399686e+04
## 22                           7.630296e+03
## 23                           1.506841e+04
## 24                           3.781764e+05
## 25                           6.252987e+00
## 26                           1.730927e+02
## 27                           6.623492e+01
## 28                           2.827282e+02
## 29                           3.534004e+01
## 30                           1.662871e+02
## 31                           4.926357e+02
## 32                           6.857976e+00
## 33                           2.046001e+03
## 34                           1.221456e+02
## 35                           3.182885e+03
## 36                           1.568488e+01
## 37                           1.176440e+01
## 38                           2.304062e+02
## 39                           1.563525e+02
## 40                           1.463009e+02
## 41                           9.146144e+01
## 42                           1.392585e+02
## 43                           6.149491e+02
## 44                           3.652272e+02
## 45                           6.631474e+02
## 46                           1.837359e+01
## 47                           0.000000e+00
## 48                           7.650891e+01
## 49                           4.391051e+01
## 50                           9.933708e-01
## 51                           1.357837e+03
## 52                           9.996373e+02
## 53                           1.911287e+03
## 54                           7.986372e+02
## 55                           4.570130e+02
## 56                           6.524750e+02
## 57                           6.486764e+00
## 58                           1.122706e+03
##    X20190123_EWM_AZD1_R30_3_2h_5.35_5uL.x
## 1                            1.809436e+03
## 2                            6.187559e+02
## 3                            4.378002e+02
## 4                            1.403436e+03
## 5                            1.189335e+03
## 6                            8.001668e+02
## 7                            2.533045e+01
## 8                            1.557267e+05
## 9                            1.869772e+05
## 10                           7.947991e+00
## 11                           5.009201e+02
## 12                           2.300305e+02
## 13                           4.207224e+04
## 14                           4.333256e+03
## 15                           3.216558e+05
## 16                           7.030526e+03
## 17                           8.905835e+04
## 18                           2.070802e+05
## 19                           1.066842e+03
## 20                           2.613004e+04
## 21                           2.587312e+04
## 22                           8.081552e+03
## 23                           1.659080e+04
## 24                           4.843777e+05
## 25                           3.311329e+01
## 26                           7.459401e+01
## 27                           5.469107e+01
## 28                           2.972709e+02
## 29                           3.937222e+01
## 30                           1.422615e+02
## 31                           4.607012e+02
## 32                           2.541417e+01
## 33                           2.240620e+03
## 34                           1.247960e+02
## 35                           3.649955e+03
## 36                           1.628580e+01
## 37                           3.618312e+01
## 38                           2.172532e+02
## 39                           1.594047e+02
## 40                           7.567751e+01
## 41                           1.450998e+02
## 42                           9.336405e+01
## 43                           2.977514e+02
## 44                           1.666218e+02
## 45                           7.146156e+02
## 46                           2.444157e+01
## 47                           0.000000e+00
## 48                           6.284256e+01
## 49                           6.410665e+01
## 50                           0.000000e+00
## 51                           1.364862e+03
## 52                           1.133226e+03
## 53                           2.317753e+03
## 54                           9.713048e+02
## 55                           4.840705e+02
## 56                           7.532772e+02
## 57                           0.000000e+00
## 58                           1.386276e+03
##    X20190123_EWM_AZD1_R30_4_2h_5.35_5uL.x
## 1                            1.555107e+03
## 2                            7.256419e+02
## 3                            1.104416e+02
## 4                            3.362259e+03
## 5                            9.547642e+02
## 6                            4.930301e+02
## 7                            5.269146e+01
## 8                            1.585629e+05
## 9                            1.734869e+05
## 10                           6.514043e+00
## 11                           2.529581e+03
## 12                           1.795736e+02
## 13                           4.353560e+04
## 14                           4.665711e+03
## 15                           7.824305e+05
## 16                           1.191763e+04
## 17                           8.650937e+04
## 18                           1.860608e+05
## 19                           9.274908e+02
## 20                           2.596120e+04
## 21                           2.500191e+04
## 22                           7.100926e+03
## 23                           1.446353e+04
## 24                           3.685051e+05
## 25                           7.303959e+00
## 26                           1.130644e+02
## 27                           0.000000e+00
## 28                           3.372267e+02
## 29                           5.415194e+01
## 30                           1.341776e+02
## 31                           5.306068e+02
## 32                           3.300558e+01
## 33                           2.000640e+03
## 34                           1.019301e+02
## 35                           2.973728e+03
## 36                           0.000000e+00
## 37                           1.665917e+01
## 38                           2.382062e+02
## 39                           1.963463e+02
## 40                           1.167093e+02
## 41                           1.382433e+02
## 42                           1.468373e+02
## 43                           3.304239e+02
## 44                           1.419413e+02
## 45                           6.806977e+02
## 46                           4.330965e+01
## 47                           1.562182e+01
## 48                           1.453521e+00
## 49                           5.611116e+01
## 50                           3.133702e+00
## 51                           1.087022e+03
## 52                           1.196767e+03
## 53                           2.043503e+03
## 54                           8.171453e+02
## 55                           4.267543e+02
## 56                           7.287456e+02
## 57                           0.000000e+00
## 58                           1.193155e+03
##    X20190123_EWM_AZD1_R60_1_2h_5.35_5uL.x
## 1                            1.890173e+03
## 2                            8.747188e+02
## 3                            8.095827e+02
## 4                            1.097780e+03
## 5                            1.102867e+03
## 6                            5.895940e+02
## 7                            4.359955e+01
## 8                            1.293510e+05
## 9                            1.705038e+05
## 10                           1.265897e-01
## 11                           1.282021e+03
## 12                           1.938973e+02
## 13                           3.540156e+04
## 14                           6.504352e+03
## 15                           3.714077e+05
## 16                           1.123190e+04
## 17                           1.219582e+05
## 18                           1.564266e+05
## 19                           8.374879e+02
## 20                           2.501717e+04
## 21                           1.990084e+04
## 22                           6.419575e+03
## 23                           1.660533e+04
## 24                           3.378253e+05
## 25                           6.467742e+01
## 26                           2.434946e+02
## 27                           2.201509e+01
## 28                           2.738587e+02
## 29                           5.208303e+01
## 30                           9.307087e+01
## 31                           1.589721e+02
## 32                           2.397526e+01
## 33                           2.849617e+03
## 34                           9.502826e+01
## 35                           2.448785e+03
## 36                           3.194473e+01
## 37                           1.206493e+01
## 38                           1.300927e+02
## 39                           2.388232e+02
## 40                           1.669772e+02
## 41                           2.449135e+02
## 42                           1.735197e+02
## 43                           3.446966e+02
## 44                           1.651947e+02
## 45                           7.287883e+02
## 46                           1.699147e+01
## 47                           4.447737e-01
## 48                           8.021418e+01
## 49                           5.139873e+01
## 50                           0.000000e+00
## 51                           1.489882e+03
## 52                           1.122114e+03
## 53                           2.736719e+03
## 54                           1.377767e+03
## 55                           5.465630e+02
## 56                           8.198138e+02
## 57                           0.000000e+00
## 58                           1.093093e+03
##    X20190123_EWM_AZD1_R60_2_2h_5.35_5uL.x
## 1                            1.477788e+03
## 2                            9.421001e+02
## 3                            1.662494e+03
## 4                            1.963879e+03
## 5                            7.981192e+02
## 6                            4.495199e+02
## 7                            2.968432e+01
## 8                            1.130870e+05
## 9                            1.446541e+05
## 10                           2.917095e+01
## 11                           6.368858e+03
## 12                           1.552725e+02
## 13                           3.031411e+04
## 14                           6.425724e+03
## 15                           6.628592e+05
## 16                           8.078324e+03
## 17                           2.434264e+05
## 18                           1.389920e+05
## 19                           5.402255e+02
## 20                           2.777921e+04
## 21                           1.965867e+04
## 22                           4.902441e+03
## 23                           1.440083e+04
## 24                           2.157179e+05
## 25                           4.152391e+01
## 26                           2.727499e+02
## 27                           4.968887e+00
## 28                           2.543672e+02
## 29                           3.319431e+01
## 30                           7.162481e+01
## 31                           9.216342e+01
## 32                           9.272504e+00
## 33                           2.044784e+03
## 34                           6.881252e+01
## 35                           1.971760e+03
## 36                           5.130477e+00
## 37                           0.000000e+00
## 38                           8.416478e+01
## 39                           2.151061e+02
## 40                           1.212016e+02
## 41                           1.556157e+02
## 42                           1.978054e+02
## 43                           4.390004e+02
## 44                           2.349423e+02
## 45                           5.413684e+02
## 46                           0.000000e+00
## 47                           6.222207e+01
## 48                           2.703278e+01
## 49                           8.492049e+01
## 50                           1.783956e+00
## 51                           1.323213e+03
## 52                           9.722052e+02
## 53                           2.108595e+03
## 54                           1.070087e+03
## 55                           4.411277e+02
## 56                           6.047978e+02
## 57                           6.805957e+00
## 58                           8.438350e+02
##    X20190123_EWM_AZD1_R60_3_2h_5.35_5uL.x
## 1                            1.495785e+03
## 2                            9.471874e+02
## 3                            1.799887e+03
## 4                            2.035959e+03
## 5                            9.367604e+02
## 6                            2.877212e+02
## 7                            2.977490e+01
## 8                            1.120691e+05
## 9                            1.529374e+05
## 10                           2.016177e+01
## 11                           4.228068e+03
## 12                           1.490501e+02
## 13                           3.263711e+04
## 14                           6.510003e+03
## 15                           6.736896e+05
## 16                           1.080815e+04
## 17                           2.120146e+05
## 18                           1.302588e+05
## 19                           6.802644e+02
## 20                           2.412383e+04
## 21                           1.820150e+04
## 22                           5.380637e+03
## 23                           1.589735e+04
## 24                           3.062155e+05
## 25                           2.774822e+01
## 26                           2.971125e+02
## 27                           3.525560e+01
## 28                           2.369198e+02
## 29                           1.795707e+01
## 30                           6.052692e+01
## 31                           9.624829e+01
## 32                           1.209028e+01
## 33                           2.306703e+03
## 34                           1.371029e+02
## 35                           2.340203e+03
## 36                           7.740210e+00
## 37                           8.462064e+00
## 38                           9.168480e+01
## 39                           1.990999e+02
## 40                           1.676586e+02
## 41                           1.474761e+02
## 42                           2.313815e+02
## 43                           4.822151e+02
## 44                           3.131576e+02
## 45                           5.378958e+02
## 46                           0.000000e+00
## 47                           0.000000e+00
## 48                           3.510775e+01
## 49                           5.973415e+01
## 50                           2.261556e+00
## 51                           1.130218e+03
## 52                           1.041131e+03
## 53                           2.549290e+03
## 54                           1.062748e+03
## 55                           3.996746e+02
## 56                           7.052666e+02
## 57                           6.841203e+00
## 58                           8.886275e+02
##    X20190123_EWM_AZD1_R60_4_2h_5.35_5uL.x
## 1                            1.780140e+03
## 2                            1.103390e+03
## 3                            9.846340e+02
## 4                            1.247897e+03
## 5                            1.129977e+03
## 6                            5.594445e+02
## 7                            3.950224e+01
## 8                            1.455371e+05
## 9                            1.716618e+05
## 10                           1.998605e+01
## 11                           1.493497e+03
## 12                           2.199106e+02
## 13                           4.068344e+04
## 14                           6.682658e+03
## 15                           3.846463e+05
## 16                           1.213422e+04
## 17                           1.143041e+05
## 18                           1.410838e+05
## 19                           7.866068e+02
## 20                           3.105087e+04
## 21                           1.934868e+04
## 22                           6.931934e+03
## 23                           1.814094e+04
## 24                           3.964267e+05
## 25                           4.837665e+01
## 26                           3.652936e+02
## 27                           1.994509e+01
## 28                           2.881614e+02
## 29                           4.200181e+01
## 30                           5.493570e+01
## 31                           9.209997e+01
## 32                           2.406680e+01
## 33                           2.740498e+03
## 34                           6.172985e+01
## 35                           2.840507e+03
## 36                           2.910724e+01
## 37                           1.430717e+01
## 38                           1.450834e+02
## 39                           2.094485e+02
## 40                           1.544882e+02
## 41                           2.172284e+02
## 42                           1.770379e+02
## 43                           3.391833e+02
## 44                           1.429956e+02
## 45                           6.010570e+02
## 46                           1.468980e+01
## 47                           6.172866e-01
## 48                           6.264315e+01
## 49                           2.292743e+01
## 50                           0.000000e+00
## 51                           1.567718e+03
## 52                           1.110550e+03
## 53                           2.627724e+03
## 54                           1.221869e+03
## 55                           4.972295e+02
## 56                           7.196692e+02
## 57                           0.000000e+00
## 58                           1.051026e+03
##  [ reached 'max' / getOption("max.print") -- omitted 424 rows ]
```


### Variable Modification



### Phosphorylation





# StatLFQ

## Packages
> Load required packages into R session.


```r
library(imp4p)
library(broom)
```


## Functions


```r
url <- "https://raw.githubusercontent.com/hickslab/ProgenesisLFQ/master/"

source_url(paste0(url, "R/StatLFQ.R"))
```

```
## SHA-1 hash of file is df904b8435ddee2f1af311fd8f1af701db112eda
```


## Workflow

> Define input data.


```r
data <- "data/20180502_WOS52_Cr_UPS_protm_Process.csv" %>%
  paste0(url, .) %>%
  read_csv(., col_types = cols()) %>%
  data.frame()
```


> Define the column indeces for replicates in each condition.

* Assuming input data has simplified format of an identifier column followed by abundance columns for each raw file in the experiment.


```r
a <- 2:5; b <- 6:9; c <- 10:13 # ???

group <- list("25" = a, "50" = b, "100" = c) # ???

group.compare <- list("25-50" = list(a, b),
                      "25-100" = list(a, c),
                      "50-100" = list(b, c))

a
```

```
## [1] 2 3 4 5
```

```r
b
```

```
## [1] 6 7 8 9
```

```r
c
```

```
## [1] 10 11 12 13
```

```r
group
```

```
## $`25`
## [1] 2 3 4 5
## 
## $`50`
## [1] 6 7 8 9
## 
## $`100`
## [1] 10 11 12 13
```

```r
group.compare
```

```
## $`25-50`
## $`25-50`[[1]]
## [1] 2 3 4 5
## 
## $`25-50`[[2]]
## [1] 6 7 8 9
## 
## 
## $`25-100`
## $`25-100`[[1]]
## [1] 2 3 4 5
## 
## $`25-100`[[2]]
## [1] 10 11 12 13
## 
## 
## $`50-100`
## $`50-100`[[1]]
## [1] 6 7 8 9
## 
## $`50-100`[[2]]
## [1] 10 11 12 13
```


> Rename the abundance columns in a simplified "Condition-Replicate" format.


```r
data <- data %>%
  rename_columns(., group)

data %>% names()
```

```
##  [1] "Accession" "25-1"      "25-2"      "25-3"      "25-4"     
##  [6] "50-1"      "50-2"      "50-3"      "50-4"      "100-1"    
## [11] "100-2"     "100-3"     "100-4"
```


> Filter to keep identifiers with >50% of replicates having nonzero abundances in any condition.

> Perform a log~2~-transformation of abundances as a variance-stabilization. The base R function *log2()* returns "-Inf" for zero values. These instances are changed to "NA" following the transformation.

> Impute missing values ("NA") using a conditional strategy with the `imp4p` package. Iterate by condition and check if each idenfifier has reliable quantitation.

* If at least one replicate has a nonzero abundance, impute other replicates with values drawn from a normal distribution centered on the mean of nonzero replicates.

* If all replicates have nonzero abundance, impute with small values drawn from a normal distribution centered on the lower 25^th^ percentile of abundances. 


```r
data2 <- data %>%
  clean_min(., group, nonzero = 3) %>%
  transform_data(., group, method = "log2") %>%
  impute_imp4p(., group)

data2 %>% plot_jitter()
```

![plot of chunk unnamed-chunk-26](figure/unnamed-chunk-26-1.png)


### Pairwise *t*-test

> Perform a *t*-test on each identifier for defined condition pairs.

* By default, a two-sided, equal-variance *t*-test is run with Benjamini-Hochberg FDR correction.


```r
data3 <- data2 %>%
  calculate_ttest(., group.compare, fdr = TRUE)
```


### One-way ANOVA

> Perform a one-way analysis of variance (ANOVA) on each identifier across conditions.

* By default, a one-way ANOVA is run for all unique conditions with Benjamini-Hochberg FDR correction.


```r
data4 <- data2 %>%
  calculate_1anova()
```


### Fold change

> Calculate fold change using the mean replicate abundance for each condition.

* Subtracting log~2~-transformed values is equivalent to dividing the non-transformed values and then transforming: $log2(B) - log2(A) = log2(B/A)$


```r
data3 <- data3 %>%
  calculate_fc(., group.compare, difference = TRUE)
```


# PlotLFQ

## Packages
> Load required packages into R session.




## Functions


```r
url <- "https://raw.githubusercontent.com/hickslab/ProgenesisLFQ/master/"

source_url(paste0(url, "R/PlotLFQ.R"))
```

```
## SHA-1 hash of file is 6506b8dc0d799f3f6dbfc64f9afba11c3451eaae
```


## Theme

> Define custom plotting elements to create a theme.


```r
theme_custom <- function(base_size = 32){
  theme_bw(base_size = base_size) %+replace%
    theme(
      strip.background = element_blank(),
      strip.text.x = element_text(size = 18),
      strip.text.y = element_text(size = 18),
      axis.text.x = element_text(size=14),
      axis.text.y = element_text(size=14,hjust=1),
      axis.ticks =  element_line(colour = "black"), 
      axis.title.x= element_text(size=16),
      axis.title.y= element_text(size=16,angle=90),
      panel.background = element_blank(), 
      panel.border = element_blank(), 
      panel.grid.major = element_blank(), 
      panel.grid.minor = element_blank(), 
      #panel.margin = unit(1.0, "lines"), 
      plot.background = element_blank(), 
      plot.margin = unit(c(0.5,  0.5, 0.5, 0.5), "lines"),
      axis.line.x = element_line(color="black", size = 1),
      axis.line.y = element_line(color="black", size = 1)
    )
}

theme_custom2 <- function(){
  theme_classic(base_size = 32) %+replace%
    theme(
      strip.background = element_blank()
      
    )
}
```

## PCA

> Principal component analysis (PCA)


```r
data2 %>%
  plot_pca(., group)
```

![plot of chunk unnamed-chunk-33](figure/unnamed-chunk-33-1.png)


## Volcano Plot

> Biological versus statistical significance


```r
data3 %>%
    plot_volcano(.,
                 group,
                 group.compare,
                 fdr = TRUE,
                 threshold = 2,
                 xlimit = 3,
                 ylimit = 9) + theme_custom2()
```

![plot of chunk unnamed-chunk-34](figure/unnamed-chunk-34-1.png)


# AnnotateLFQ

## Packages
> Load required packages into R session.




## Functions


```r
url <- "https://raw.githubusercontent.com/hickslab/ProgenesisLFQ/master/"

source_url(paste0(url, "R/AnnotateLFQ.R"))
```

```
## SHA-1 hash of file is d2edc6c602c09ddab41aa269eaa56ea3e588a79f
```


## UniProtKB API

> Given a list of protein accessions, access UniProtKB and pull known information.






# Output

## Saving Data from R

> The *write_csv()* function from the `readr` package in `tidyverse` is one option to save a dataframe copy in the working directory.


```r
#data3 %>% write_csv(., "data3.csv")
```

